#!/usr/bin/python
# make the best alignment we can using the maps
# we currently have at hand

import MySQLdb, commands, re

from ctypes    import *
from alignment import *
from el_utils.alignment  import smith_waterman, exon_aware_smith_waterman
from   time    import  time
#########################################
def main():

    seq1 = "B001MSSAQCPALVCVMSRLRFWGPWPLLMWQLLWLLVKEAQPLEWVKDPLQLTSNPLGPPDSWSSHSSHFPRESPHAPTLPADPWDFDHLGPSASSEMPAPPQESTENLVPFLDTWDSAGEQPLEPEQFLASQQDLKDKLSPQERLPVSPKKLKKDPAQRWSLAEIIGITRQLSTPQSQKQTLQNEYSSTDTPYPGSLPPELRVKSDEPPGPSEQVGPSQFHLEPETQNPETLEDIQSSSLQQEAPAQLPQLLEEEPSSMQQEAPALPPESSMESLTLPNHEVSVQPPGEDQAYYHLPNITVKPADVEVTITSEPTNETESSQAQQETPIQFPEEVEPSATQQEAPIEPPVPPMEHELSISEQQQPVQPSESPREVESSPTQQETPGQPPEHHEVTVSPPGHHQTHHLASPSVSVKPPDVQLTIAAEPSAEVGTSLVHQEATTRLSGSGNDVEPPAIQHGGPPLLPESSEEAGPLAVQQETSFQSPEPINNENPSPTQQEAAAEHPQTAEEGESSLTHQEAPAQTPEFPNVVVAQPPEHSHLTQATVQPLDLGFTITPESKTEVELSPTMKETPTQPPKKVVPQLRVYQGVTNPTPGQDQAQHPVSPSVTVQLLDLGLTITPEPTTEVGHSTPPKRTIVSPKHPEVTLPHPDQVQTQHSHLTRATVQPLDLGFTITPKSMTEVEPSTALMTTAPPPGHPEVTLPPSDKGQAQHSHLTQATVQPLDLELTITTKPTTEVKPSPTTEETSTQPPDLGLAIIPEPTTETRHSTALEKTTAPRPDRVQTLHRSLTEVTGPPTELEPAQDSLVQSESYTQNKALTAPEEHKASTSTNICELCTCGDEMLSCIDLNPEQRLRQVPVPEPNTHNGTFTIZB002LNFQGNYISYIDGNVWKAYSWTEKZB003LILRENNLTELHKDSFEGLLSLQYZB004LDLSCNKIQSIERHTFEPLPFLKFZB005INLSCNVITELSFGTFQAWHGMQFLHKZB006LILNHNPLTTVEDPYLFKLPALKYZB007LDMGTTLVPLTTLKNILMMTVELEKZB008LILPSHMACCLCQFKNSIEAVCKTVKLHCNSACLTNTTHCZB009PEEASVGNPEGAFMKVLQARKNYTSTELIVEPEEPSDSSGINLSGFGSEQLDTNDESDFISTLSYILPYFSAVNLDVKSLLLPFIKLPTTGNSLAKIQTVGQNRQRVKRVLMGPRSIQKRHFKEVGRQSIRREQGAQASVENAAEEKRLGSPAPREVEQPHTQQGPEKLAGNAVYTKPSFTQEHKAAVSVLKPFSKGAPSTSSPAKALPQVRDRWKDLTHAISILESAKARVTNTKTSKPIVHARKKYRFHKTRSHVTHRTPKVKKSPKVRKKSYLSRLMLANRLPFSAAKSLINSPSQGAFSSLGDLSPQENPFLEVSAPSEHFIENNNTKHTTARNAFEENDFMENTNMPEGTISENTNYNHPHEADSAGTAFNLGPTVKQTETKWEYNNVGTDLSPEPKSFNYPLLSSPGDQFEIQLTQQLQSLIPNNNVRRLIAHVIRTLKMDCSGAHVQVTCAKLISRTGHLMKLLSGQQEVKASKIEWDTDQWKIENYINESTEAQSEQKEKSLEZB010LKKEVPGYGYTDKLILALIVTGILTILIILFCLIVZB011ICCHRRSLQEDEEGFSZB012RGIFRFLPWRGCSSRRESQZB013DGLSSFGQPLWFKDMYKPLSATRINNHAWKLHKKSSNEDKILNRDPZB014GDSEAPTEEEESEALPZ"
    seq2 = "B001ITGKPLSLELTISSQPPTETGPFSTQZB002TPEPPKEVEPSPFQQEAPVQSPEPPMPPELSPSQQEAPALSPEPPKEVESSLVQQETPPQPLQSTTQZB003EEAPALPPEPFESTQPFSVQHTASSRPPEPPKEVEPSPSQQEAPASPPEPPNEVEPPPSLQEVPPQTSEPSKEAEPSPTQQEAPVHPSEAPKEZB004ITAQPLDLELTITPEHTMKAEHSTTPQRTTTSPPICPEVTIPHPDQFQAQHPNLPESTVQPLDLELIVTPGPTIQVEHSTPLQKTTASSPZB005KQETPTQPPEPPKEVVAQPLVNHEVTTPSSRQDQAQHSNLPKVTVKPVDLELTVSPEPTTEAEYSTTLQKTTVPPTKQVTIQTLDLELSISPEPKTLTKQGTPTRPPEPPKGVVAQHPAHHEATVSPPGQDQAQHSNLPNZB006NNTTSSPERPEVTLPPPDQVQAQHPNLTEVTDQTLDLELTVMPEFTSKTEHSTALQKATPLPKQITVQPLNLEPTVSPEPIPEVQHTTALQETTPPPKRVTZB007WEQNATNGMSICELCVCQDETLSCTGLRPEKRLHRVPVPEPNEYNGTFTVZB008LNFQGNSISYIEENIWKAYRWTEKZB009LILSENSLTELRKDSFEGLLSLQYZB010LDLSCNKIQSIERRTFEPLPFLKFZB011INLGCNLITELGFGTFQAWHGMQFLQTZB012LVLNRNPLTAIEDSYLFKLPALKYZB013LDMGTTQVSLTTVENILIKTLQLEKZB014LILPSHMACCLCQFKSTIEVVCKTVKLRCDSGCLINSTHCZB015SEEPSLGAAEGTFMKALQARKKNTSTELTIEPEAASSDRSSVNLSTVLNEPLGFNDESDVISALNYVLPYFSEGNLEHIEMTLLPFIKLLFSKVQDREKALSDLQNNTGNPPLKPKNNNATYRSKLRKLYFLENLLDAEIQEKIDEVKKKEKAAMLTYPNFLDAIFKRQIFQKKLETAQPWENHLANIHRTGVGKRPQRVSRDFKRPRGIKKRHFKGMDYLNIKRKQGAKPFMENTPKARRPLRPLSKKVDRLLEVRRQRKVGGVSFNTEPSSSKEHKAAVSSSLKQYSMGRPSTSPPSKAPPEVRILSKDLSYTFFVLEEANARVKNIKETPZB016KRPKAKTSRRFRKVRKLMLRNRPPSSAVRSLINSPPREAFSSSGELSSPENPFQEWFPFSGPSAKNITVHNATMLGETTPEITAHKDPSTADSVVTADNFMASVKQTNETQWEYQNMGPDLPSKPHGSSLPLLSSPGDQFETQLNQQLQSLIPNKDVRRLIAHVMRTLKLDCSEPQVQLACAKLLSRTGLLMKLLSEQQEVKVSKADWDTDQWKTENYINESTEVHSEQKEQESSEZB017LTKEVPGYGYNHKLILAISVTVVVMILIFCLIEVZ"

    start = time()
    [aligned_seq1, aligned_seq2] = exon_aware_smith_waterman (seq1, seq2)
    print "  python time: %8.3f\n" % ( time()-start);

    start = time()
    [aligned_seq1, aligned_seq2] = smith_waterman_context(seq1, seq2)
    print "   C time: %8.3f\n" % ( time()-start);

    #print ">seq1"
    #print aligned_seq1
    #print ">seq2"
    #print aligned_seq2


#########################################
if __name__ == '__main__':
    main()
